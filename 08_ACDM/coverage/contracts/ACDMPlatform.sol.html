<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts\ACDMPlatform.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> ACDMPlatform.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">97.4% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>75/77</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">86.11% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>31/36</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">94.12% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>16/17</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">97.5% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>78/80</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-yes">83×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">96×</span>
<span class="cline-any cline-yes">96×</span>
<span class="cline-any cline-yes">96×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">26×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">26×</span>
<span class="cline-any cline-yes">26×</span>
<span class="cline-any cline-yes">26×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">62×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">82×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">122×</span>
<span class="cline-any cline-yes">122×</span>
<span class="cline-any cline-yes">98×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">122×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">22×</span>
<span class="cline-any cline-yes">22×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">22×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">//SPDX-License-Identifier: Unlicense
pragma solidity 0.8.15;
&nbsp;
import "@openzeppelin/contracts/access/AccessControl.sol";
&nbsp;
interface IACDM_TOKEN {
    function mint(uint256 _amount) external;
&nbsp;
    function transfer(address to, uint256 amount) external returns (bool);
&nbsp;
    function transferFrom(
        address from,
        address to,
        uint256 amount
    ) external returns (bool);
&nbsp;
    function burn(uint _amount) external;
&nbsp;
    function balanceOf(address account) external view returns (uint256);
&nbsp;
    function decimals() external returns (uint8);
}
&nbsp;
contract ACDMPlatform is AccessControl {
    bytes32 public constant DAO = keccak256("DAO");
&nbsp;
    bool started;
    IACDM_TOKEN acdmToken;
    uint[2] public saleRoundReferRewards = [50, 30];
    uint[2] public tradeRoundReferRewards = [25, 25];
    uint commonSaleRoundReferPercent = 80;
    uint commonTradeRoundReferPercent = 50;
    uint public referralRewardBank;
    uint roundDuration = 3 days;
    uint public tradeRoundVolume = 1 ether;
    uint public lastPrice = 10000000;
    uint public acdmEmission = 100000;
    uint roundStartTime;
    uint acdmTokenDecimals;
&nbsp;
    struct Order {
        bool executed;
        address payable seller;
        uint amount;
        uint price;
    }
&nbsp;
    Order[] public orders;
&nbsp;
    event OrderPlaced(uint id, uint amount, uint price);
    event OrderExecuted(uint _id);
    event OrderUpdated(uint _id, uint amount);
    event OrderRemoved(uint _id);
&nbsp;
    enum Status {
        Pending,
        Sale,
        Trade
    }
&nbsp;
    Status public status;
&nbsp;
    mapping(address =&gt; address) public refers;
    mapping(address =&gt; bool) public registered;
&nbsp;
    modifier onlySaleRound() {
        require(status == Status.Sale, "Not sale round");
        _;
    }
    modifier onlyTradeRound() {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status == Status.Trade, "Not trade round");
        _;
    }
&nbsp;
    constructor(address _acdmToken) {
        acdmToken = IACDM_TOKEN(_acdmToken);
        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);
        registered[msg.sender] = true;
    }
&nbsp;
    ///@notice Start platform and first sale round
    function startPlatform() external onlyRole(DEFAULT_ADMIN_ROLE) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status == Status.Pending, "Already started");
&nbsp;
        roundStartTime = block.timestamp;
        acdmToken.mint(acdmEmission * 10**acdmToken.decimals());
        status = Status.Sale;
    }
&nbsp;
    ///@notice Buy acdm token with ETH during Sale round
    function buyAcdm() external payable onlySaleRound {
        require(
            roundStartTime + 3 days &gt;= block.timestamp,
            "Sale round time expired"
        );
        require(msg.value &gt; lastPrice, "Not enough ether to buy token");
        acdmToken.transfer(msg.sender, msg.value / lastPrice);
        _transferSaleReferReward(msg.sender, msg.value);
    }
&nbsp;
    function startSaleRound() external onlyTradeRound {
        require(
            roundStartTime + 3 days &lt;= block.timestamp,
            "Trade round is not over yet"
        );
        //return acdm tokens to sellers
        for (uint i = 0; i &lt; orders.length; i++){
            Order storage order = orders[i];
            if (!order.executed){
                acdmToken.transfer(order.seller, order.amount);
            }
        }
&nbsp;
        //clear array
        delete orders;
&nbsp;
        _updateTokenPrice();
&nbsp;
        acdmEmission = tradeRoundVolume / lastPrice;
        acdmToken.mint(acdmEmission * 10**acdmToken.decimals());
        roundStartTime = block.timestamp;
        status = Status.Sale;
    }
&nbsp;
    ///@notice Starts trade round if sale round time expired or sold out
    function startTradeRound() external onlySaleRound {
        require(
            ((roundStartTime + 3 days &lt;= block.timestamp) ||
                (acdmToken.balanceOf(address(this)) == 0)),
            "Sale round is not over yet"
        );
        tradeRoundVolume = 0;
        roundStartTime = block.timestamp;
        status = Status.Trade;
    }
&nbsp;
    ///@notice Add order during Trade Round
    function addOrder(uint _amount, uint _price) external onlyTradeRound {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            roundStartTime + 3 days &gt;= block.timestamp,
            "Trade round time is over"
        );
        acdmToken.transferFrom(msg.sender, address(this), _amount);
        orders.push(Order(false, payable(msg.sender), _amount, _price));
        emit OrderPlaced(orders.length - 1, _amount, _price);
    }
&nbsp;
    ///@notice redeem order during the Trade Round
    function redeemOrder(uint _id) external payable onlyTradeRound {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            roundStartTime + 3 days &gt;= block.timestamp,
            "Trade round time is over"
        );
        Order storage order = orders[_id];
        require(!order.executed, "Order executed");
        uint amount = msg.value / order.price;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(order.amount &gt;= amount, "Not enough tokens");
        acdmToken.transfer(msg.sender, amount);
        order.amount -= amount;
        if (order.amount == 0) {
            order.executed = true;
            emit OrderExecuted(_id);
        } else {
            emit OrderUpdated(_id, order.amount);
        }
        tradeRoundVolume += msg.value;
        payable(order.seller).transfer(
            (msg.value * (1000 - commonTradeRoundReferPercent)) / 1000
        );
        _transferTradeeReferReward(order.seller, msg.value);
    }
&nbsp;
    ///@notice remove caller's order
    function removeOrder(uint _id) external onlyTradeRound {
        require(
            roundStartTime + 3 days &gt;= block.timestamp,
            "Trade round time is over"
        );
        Order storage order = orders[_id];
        require(order.seller == msg.sender, "You are not a seller");
        order.executed = true;
        acdmToken.transfer(msg.sender, order.amount);
        emit OrderRemoved(_id);
    }
&nbsp;
    ///@notice User registration
    function register(address _refer) external {
        require(registered[_refer], "Reffer not registered");
        registered[msg.sender] = true;
        refers[msg.sender] = _refer;
    }
&nbsp;
    ///@notice  Deposits reffer rewards. Method called after each sale transaction.
    function _transferSaleReferReward(address _iniciator, uint _value) private {
        address currentRefer = refers[_iniciator];
        for (uint i = 0; i &lt; saleRoundReferRewards.length; i++) {
            uint reward = (_value * saleRoundReferRewards[i]) / 1000;
            if ((currentRefer != _iniciator) &amp;&amp; (currentRefer != address(0))) {
                payable(currentRefer).transfer(reward);
            } else {
                referralRewardBank += reward;
            }
            currentRefer = refers[currentRefer];
        }
    }
&nbsp;
    ///@notice  Deposits reffer rewards. Method called after each trade transaction.
    function _transferTradeeReferReward(address _iniciator, uint _value)
        private
    {
        address currentRefer = refers[_iniciator];
        for (uint i = 0; i &lt; tradeRoundReferRewards.length; i++) {
            uint reward = (_value * tradeRoundReferRewards[i]) / 1000;
            if ((currentRefer != _iniciator) &amp;&amp; (currentRefer != address(0))) {
                payable(currentRefer).transfer(reward);
            } else {
                referralRewardBank += reward;
            }
            currentRefer = refers[currentRefer];
        }
    }
&nbsp;
    ///@notice Sets new percent rate for reffer rewards in sale round
    function setSaleRoundReferRewards(uint _newPercent1, uint _newPercent2)
        external
        onlyRole(DAO)
    {
        saleRoundReferRewards[0] = _newPercent1;
        saleRoundReferRewards[1] = _newPercent2;
        commonSaleRoundReferPercent = _newPercent1 + _newPercent2;
    }
&nbsp;
    ///@notice Sets new percent rate for reffer rewards in trade round
    function setTradeRoundReferRewards(uint _newPercent1, uint _newPercent2)
        external
        onlyRole(DAO)
    {
        tradeRoundReferRewards[0] = _newPercent1;
        tradeRoundReferRewards[1] = _newPercent2;
        commonTradeRoundReferPercent = _newPercent1 + _newPercent2;
    }
&nbsp;
    ///@notice Change token price every saleRound
    function _updateTokenPrice() private {
        lastPrice = (lastPrice * 103) / 100 ;
        //@FIX
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function withdraw() external onlyRole(DEFAULT_ADMIN_ROLE) {</span>
<span class="cstat-no" title="statement not covered" >        uint balanceToWithdraw = address(this).balance - referralRewardBank;</span>
<span class="cstat-no" title="statement not covered" >        payable(msg.sender).transfer(balanceToWithdraw)</span>;
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Aug 06 2022 13:56:15 GMT+0300 (Москва, стандартное время)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
